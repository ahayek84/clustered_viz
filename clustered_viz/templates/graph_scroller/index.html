{% extends 'base.html' %}
{% block content %}
    {% load static %}
        <link href="{% static 'resources\js\graph_scroller\gs.css' %}" rel="stylesheet">
    <div class="container-fluid">
        <!--
        Begin the work
        -->
        <h1><a href='https://github.com/1wheel/graph-scroll'>graph-scroll.js</a></h1>
        <h1>Simple scrolling events for d3 graphics</h1>

        <div id='container' class='container-1'>
            <div id='graph'></div>
            <div id='sections'>
                <div>
                    <h3>Connect text and graphics</h3>
                    <span class='mono'>graph-scroll</span>
                    takes a selection of explanatory text sections and dispatches <span class='mono'>active</span>
                    events as different sections are scrolled into to view. These active events are used to update a
                    graph's state.
                </div>

                <div>
                    <h3>Highlight active text</h3>
                    The top most text section scrolled into view is classed <span
                        class='mono'>graph-scroll-active</span>. This makes it easy to highlight the active section with
                    css:
                                        <pre>
                    #sections > div{
                      opacity: .3
                    }

                    #sections div.graph-scroll-active{
                      opacity: 1;
                    }
                    </pre>
                </div>


                <div>
                    <h3>Headers and footers</h3>
                    To support headers and intro images/text, the explanatory text and graphic are wrapped with a
                    container element:
                                        <pre>
                    &lt;h1&gt;Page Title&lt;/div&gt;
                    &lt;div id='container'&gt;
                      &lt;div id='graph'&gt;&lt;/div&gt;
                      &lt;div id='sections'&gt;
                        &lt;div&gt;Section 0&lt;/div&gt;
                        &lt;div&gt;Section 1&lt;/div&gt;
                        &lt;div&gt;Section 2&lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;h1&gt;Footer&lt;/h1&gt;
                    </pre>

                    and passed to <span class='mono'>graphScroll</span>

                    <pre>
d3.graphScroll()
  .graph(d3.select('#graph'))
  .container(d3.select('#container'))
<pre>
                </div>

                <div>
                    <h3>Sticky graph</h3>
                    When the graph starts to scroll out of view, <span class='mono'>postiion: sticky</span> keeps the
                    graph element stuck to the top of the page while the text scrolls by.
                                        <pre>
                    #container{
                      position: relative;
                    }

                    #sections{
                      width: 340px;
                    }

                    #graph{
                      margin-left: 40px;
                      width: 500px;
                      position: sticky;
                      top: 0px;
                      float: right;
                    }
                    </pre>
                </div>

            </div>

        </div>
        <!--
        End the work
        -->
    </div>

{% endblock %}

<!-- load my custome js -->
{% load static %}
{% block scripts %}
    <script type="text/javascript" src="{% static 'resources\js\d3v4+jetpack.js' %}"></script>
    <script type="text/javascript" src="{% static 'resources\js\graph-scroll.js' %}"></script>
    <script>
        var oldWidth = 0
        function render() {
            if (oldWidth == innerWidth) return
            oldWidth = innerWidth
            var width = height = d3.select('#graph').node().offsetWidth
            var r = 40
            if (innerWidth <= 925) {
                width = innerWidth
                height = innerHeight * .7
            }
            // return console.log(width, height)
            var svg = d3.select('#graph').html('')
                .append('svg')
                .attrs({width: width, height: height})
            var circle = svg.append('circle')
                .attrs({cx: 0, cy: 0, r: r})
            var colors = ['orange', 'purple', 'steelblue', 'pink', 'black']
            var gs = d3.graphScroll()
                .container(d3.select('.container-1'))
                .graph(d3.selectAll('container-1 #graph'))
                .eventId('uniqueId1')  // namespace for scroll and resize events
                .sections(d3.selectAll('.container-1 #sections > div'))
                // .offset(innerWidth < 900 ? innerHeight - 30 : 200)
                .on('active', function (i) {
                    var pos = [{cx: width - r, cy: r},
                        {cx: r, cy: r},
                        {cx: width - r, cy: height - r},
                        {cx: width / 2, cy: height / 2}][i]

                    circle.transition().duration(1000)
                        .attrs(pos)
                        .transition()
                        .style('fill', colors[i])
                })
            d3.select('#source')
                .styles({'margin-bottom': window.innerHeight - 450 + 'px', padding: '100px'})
        }
        render()
        d3.select(window).on('resize', render)
    </script>

{% endblock %}



